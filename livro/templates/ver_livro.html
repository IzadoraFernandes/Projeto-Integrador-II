{% extends 'base.html' %}
{% load filtros %}

{% block 'conteudo' %}
<div class="container">
    <br>

    <a href="{%url 'sair' %}" class="btn btn-danger"> Sair </a>

    <form action="" method="POST">
      {% csrf_token %}

      <p>
      <label>Nome do livro:</label>
      <input class= "form-contol" type="text" value="{{livro.nome_livro}}">
      </p>

      <p> 
      <label>Autor:</label>
      <input style="width:40%" class= "form-contol" type="text" value="{{livro.autor}}">
      </p>

      <p> <label>Coautor:</label>
      <input style="width:40%" class= "form-contol" type="text" value="{{livro.co_autor}}"> 
      </p>

      <p> <label>Data de cadastro:</label>
          <input style="width:40%" class= "form-contol" type="text" value="{{livro.data_cadastro}}">
      </p>

      <p> <label>Categoria:</label>
          {{livro.categoria}}
          <select style="width: 20%;" class="form-control" name="categoria_id">
            {% for i in categoria_livro%}
            
              {% if livro.categoria.nome == i.nome %}
                <option value="{{i.id}}" selected>{{i}}</option>

              {% else %}
                <option value="{{i.id}}">{{i}}</option>
              {% endif%}

            {% endfor %}

          </select>
      </p>

      <label> Emprestado: </label>
      {% if livro.emprestado %}
          {{livro.quantidade }} <svg style="color: green;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-lg" viewBox="0 0 16 16">
          <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
          </svg>
      {% else %} 
          Livro não emprestado
      {% endif %}
          <br>
             
  </div>

  <input type="submit" class="btn btn-success btn-lg" value="Salvar">
</form>
<hr>

<br>
    <button type="button" class="btn btn-danger btn-lg" data-toggle="modal" data-target="#exampleModal2">
      Excluir
    </button>
    
    <hr>

    <h2>Histórico de emprestimo</h2>

    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Nome</th>
          <th scope="col">Data Emprestimo</th>
          <th scope="col">Data devolução</th>
          <th scope="col">Tempo de duração</th>
        </tr>
      </thead>
      <tbody>
        {% for i in emprestimos %}
        <tr>
          {% if i.nome_emprestado_anonimo == None%}

            <th scope="row">{{i.nome_emprestado_usuario}}</th>
            <td>{{i.data_emprestado}}</td>
            <td>{{i.data_devolucao}}</td>

          {% else %}

            <th scope="row">{{i.nome_emprestado_anonimo}}</th>
            <td>{{i.data_emprestado}}</td>
            <td>{{i.data_devolucao}}</td>
            <td>{{i.data_devolucao|mostra_duracao:i.data_emprestado}}</td> <!-- value1|mostra_devolucao:value2-->
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
      
    </table>

{% endblock %}